# SELinux module (loadable) to confine ban space
# Note: absence of 'allow' implies DENY for untrusted_app; we provide allow rules to ban_enforcer_t only.

policy_module(ban_enforcer, 1.0)

type ban_enforcer_t;
type ban_space_t;

# Ban enforcer domain can manage the ban_space_t trees
allow ban_enforcer_t ban_space_t:dir  { create read getattr open search write add_name remove_name rmdir };
allow ban_enforcer_t ban_space_t:file { create read getattr open write unlink rename };

# Give enforcer minimal system access (adjust to your service binary labels)
allow ban_enforcer_t self:process { fork sigchld };
allow ban_enforcer_t self:tcp_socket { create bind connect getopt setopt };
allow ban_enforcer_t net_dns_selinux_t:tcp_socket name_connect;

# Do NOT add allows for untrusted_app -> ban_space_t (default deny keeps data opaque)